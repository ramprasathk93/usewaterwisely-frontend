<!DOCTYPE html>
<head>
    <!-- The header of HTML page to use the Java script -->
    <script src="js/jquery.min.js"></script>
    <script src="js/echarts.common.min.js"></script>
    <script src="js/d3.v4.js" language="JavaScript"></script>
    <script src="js/bootstrap3-typeahead.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="//oss.maxcdn.com/jquery.trip.js/3.3.3/trip.min.js"></script>
    <!-- The link to mention the css style of the website -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="//oss.maxcdn.com/jquery.trip.js/3.3.3/trip.min.css"/>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <style>

        #panel
        .gmap-popup {
            max-width:200px;
            max-height:100px;
        }

        .wrapper {
            clear:both;
        }

        /* On smaller screens, decrease text size */
        @media only screen and (max-width: 300px) {
            .text {font-size: 11px}
        }

        .mySlides {display:none}
        .w3-left, .w3-right, .w3-badge {cursor:pointer}
        .w3-badge {height:13px;width:13px;padding:0}

        .img-responsive{
            width:40px;
        }
        img{
            display: block;
            margin: auto;
            width: 40%;
        }
        td{
            width: 14%;
            text-align: center;
        }
        #map{
            height: 100%;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #description {
            font-family: Roboto;
            font-weight: 300;
        }
        #infowindow-content .title {
            font-weight: bold;
        }

        #infowindow-content {
            display:  block;
        }

        #map #infowindow-content {

        }

        .pac-card {
            margin: 10px 10px 0 0;
            border-radius: 2px 0 0 2px;
            box-sizing: border-box;
            -moz-box-sizing: border-box;
            outline: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            font-family: Roboto;
        }

        #pac-container {
            padding-bottom: 12px;
            margin-right: 12px;
        }

        .pac-controls {
            display: inline-block;
            padding: 5px 11px;
        }

        .pac-controls label {
            font-family: Roboto;
            font-weight: 300;
        }

        #pac-input {
            font-family: Roboto;
            font-weight: 300;
            margin-top: 10px;
            margin-left: 10px;
            padding: 0 11px 0 13px;
            text-overflow: ellipsis;
            width: 400px;

        }

        #pac-input:focus {
            border-color: #4d90fe;
        }

        #target {
            width: 345px;
        }

        #delete-button {
            margin-top: 10px;
        }
        .pac-container{
            z-index: 1051 !important;
        }

        #container {
            margin-left: auto;
            margin-right: auto;
            border: 1px solid black;
            overflow: auto;
            width: 800px;
        }
        #nav {
            width: 19%;
            border: 1px solid green;
            float:left;
        }
        #content {
            width: 79%;
            border: 1px solid red;
            float:right;
        }

    </style>
    <meta charset="utf-8">
    <title>UseWaterWisely</title>
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/res.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="js/bootstrap3-typeahead.min.js"></script>
    <script async src="//jsfiddle.net/geocodezip/hk82v0zp/2/embed/"></script>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAHSdBgQpz0JTttbx_Y4eyi4ztWCFVy5ZA&libraries=drawing,places&"></script>
    <script type="text/javascript">

        function calroof()
        {
            $("#myModal").modal('show');
            $('#myModal').on('shown.bs.modal', function () {
            });
        }

    </script>
    <!-- Mention the shotcut icon for images -->
    <style>
        @font-face { font-family: Bat; src: url('style/dark.ttf'); }

    </style>
</head>
<body>
<div class="panel" style="background-image: url('img/waterflow.jpg'); background-size:100% auto;">
    <div class="panel-heading" style="text-align: center;vertical-align: middle;background-attachment: fixed;background-position: center;">
        <h1 style="font-family: bat;font-size: 60px;">UseWaterWisely</h1>
    </div>

<div class="panel-body"></div>
    <div class="container" >

        <div id="mainMenuBarAnchor"></div>
        <div class="wrapper " id="mainMenuBar" style="background-color: skyblue;">
            <br>
            <div class="inner" style="">
                <form class="form-inline">

                    <div class="form-group" style="margin-right: 20px;margin-left: 20px;">
                        <input type="text" style="min-width: 150px;"id="localization" class="form-control" placeholder="Enter suburb name" onchange="">
                    </div>
                    <div class="form-group" style="margin-right: 20px;margin-left: 20px;">
                        <label style="font-size:20px;font-family: Arial;"><input type="checkbox" id="checkTank"> I have a tank </label>
                        <input type="text" style="display: none;min-width: 150px;" id="waterLitre" class="form-control" placeholder="Enter tank size" onchange="" >
                    </div>
                    <div class="form-group" style="margin-right: 20px;margin-left: 20px;">
                        <label style="font-size:20px;font-family: Arial;"><input type="checkbox" id="checkRoof" style="font-size:30px;font-family: Arial;"> I know my roof area  </label>
                        <input type="text" style="display: none;min-width: 150px;"id="area" class="form-control" placeholder="Enter roof area" onchange="">
                    </div>
                    <div class="form-group" style="margin-right: 20px;margin-left: 20px;">
                        <!-- Button HTML (to Trigger Modal) -->
                        <a href="#" id="calculateR"class="btn btn-md btn-default" onclick="calroof()">Calculate roof area</a>

                        <!-- Modal HTML -->
                        <div id="myModal" class="modal fade">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        <h4 class="modal-title">Locate your house and click on your roof to draw a shape</h4>
                                    </div>
                                    <div class="modal-body" style="width: 500px; height:500px;">

                                        <div id="map" style=""></div>
                                        <input id="pac-input" id="homeAd"class="controls" type="text" style="height: 30px;width: 200px;"placeholder="Type in your home address">

                                    </div>
                                    <div class="modal-footer">
                                        <div>
                                            <div id="areaB"></div>
                                        </div>
                                        <button id="delete-button" class="btn btn-default" style="margin-top: -1px;"onclick="deleteSelectedShape()">Delete Selected Shape</button>
                                        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="saveRoof()">Save and Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                         </div>
                    <div class="form-group" style="margin-right: 20px;margin-left: 20px;">
                        <input type="text" id="peopelNum" style="min-width: 160px;"class="form-control" placeholder= "Number of residents" onchange="">
                    </div>

                    <button type="button" style="margin-right: 20px;margin-left: 20px;" id="submitAPI" class="btn btn-md btn-primary" onClick="submitAll()" style="float:right"> Get Tank Size Suggestion </button>
                </form>
            </div>

            <br>
        </div>
        <div id="showResult" style="width: 1200px; display:none; background-color: white;" >
            <div id = "part1" style="border-style: solid; border-color:black; border-width:3px;">
                <h4>Your tank water levels from the rainwater collected from your roof</h4>
                <div id = "chartID" style="background-color: white;">

                </div>
            </div>

            <hr>
            <div id="part2" style="border-style: solid; border-color:black; border-width:3px;">
                <h4>Your Household Demands for any month in an year</h4>
                <div id = "DemandChart" style="background-color: white;">

                    <table class="table table-bordered table-hover">
                        <thead>
                        <tr>
                            <th><img src="images/demand.png" class="img-responsive" alt="" border=3 height=40 width=40></img></th>
                            <th><img src="images/shower.png" class="img-responsive" alt="" border=3 height=40 width=40></img></th>
                            <th><img src="images/toilet.png" class="img-responsive" alt="" border=3 height=40 width=40></img></th>
                            <th><img src="images/kitchen.png" class="img-responsive" alt="" border=3 height=40 width=40></img></th>
                            <th><img src="images/gardening.png" class="img-responsive" alt="" border=3 height=40 width=40></img></th>
                            <th><img src="images/washing.png" class="img-responsive" alt="" border=3 height=40 width=40></img></th>
                            <th><img src="images/water_misc.png" class="img-responsive" alt="" border=3 height=40 width=40></img></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><span style="font-weight:bold">Total Demands(Litres)</span></td>
                            <td>7-9 min Shower</td>
                            <td>Dual-flush Toilet</td>
                            <td>Kitchen</td>
                            <td>Gardening</td>
                            <td>Washing Machine</td>
                            <td>Miscellaneous</td>
                        </tr>
                        <tr>
                            <td id="total"></td>
                            <td id="shower"></td>
                            <td id="toilet"></td>
                            <td id="kitchen"></td>
                            <td id="gardening"></td>
                            <td id="washing"></td>
                            <td id="misc"></td>
                        </tr>
                        <tr>
                            <td><span style="font-weight:bold">Recommended Water Practices(per person)</span></td>
                            <td>1 shower per day with AAA rated showerhead </td>
                            <td>35 flushes per week</td>
                            <td>Use of dishwasher and water efficient taps</td>
                            <td>Use of Water efficient Irrigation systems</td>
                            <td>1-2 loads per week with AAA rated washing machine</td>
                            <td>Minimised water use for cleaning purposes</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <hr>
            <div id="part3" style="border-style: solid; border-color:black; border-width:3px;">
                <h4>Security of water supply for your household requirements</h4>
                <p>The chart below shows the percentage of water that can serve your demands from the tank.</p>
                <div id = "securityChart" style="background-color: white;">

                </div>
            </div>

            <hr>
            <div id="part4" style="border-style: solid; border-color:black; border-width:3px;">
                <h4 align="middle">Tank Size Suggestions</h4>
                <p>Enter the suggested sizes as the tank size above and get to know about your water resources. The suggestions are based on your household demands and roof area.</p>
                <div id = "suggestionChart" style="background-color: white;">

                </div>
            </div>

        </div>

    </div>

        <div class="w3-content w3-display-container" id ="slidePage"style="max-width:100%;border-style:solid;border-color:white; ">
            <img class="mySlides" src="img/1.png" style="width:100%">
            <img class="mySlides" src="img/2.png" style="width:100%">
            <img class="mySlides" src="img/3.png" style="width:100%">
            <img class="mySlides" src="img/4.png" style="width:100%">
            <img class="mySlides" src="img/5.png" style="width:100%">
            <button class="w3-button w3-display-left w3-black" style="vertical-align: center;"onclick="plusDivs(-1)">&#10094;</button>
            <button class="w3-button w3-display-right w3-black" style="vertical-align: center;"onclick="plusDivs(1)">&#10095;</button>
            <div class="w3-center w3-container w3-section w3-large w3-text-white w3-display-bottommiddle" style="width:100%">

                <span class="w3-badge demo w3-border-black w3-transparent w3-hover-white" style="border-color: black;border-style: solid;"onclick="currentDiv(1)"></span>
                <span class="w3-badge demo w3-border-black w3-transparent w3-hover-white" style="border-color: black;border-style: solid;" onclick="currentDiv(2)"></span>
                <span class="w3-badge demo w3-border-black w3-transparent w3-hover-white" style="border-color: black;border-style: solid;" onclick="currentDiv(3)"></span>
                <span class="w3-badge demo w3-border-black w3-transparent w3-hover-white" style="border-color: black;border-style: solid;" onclick="currentDiv(4)"></span>
                <span class="w3-badge demo w3-border-black w3-transparent w3-hover-white" style="border-color: black;border-style: solid;" onclick="currentDiv(5)"></span>
            </div>
        </div>

    <div class="panel-footer">  &copy; Copyright by The Superflys 2017 - Monash University Industry Project - All rights reserved.</div>

</div>

</body>
<script>
    causeRepaintsOn = $("h1, h2, h3, p");

    $(window).resize(function() {
        causeRepaintsOn.css("z-index", 1);
    });

    $('#checkTank').click(function() {
        $('#waterLitre')[this.checked ? "show" : "hide"]();
        if ($(this).is(':checked')) {
            document.getElementById("submitAPI").innerHTML = "Use Water Wisely";
        }
        else{
            document.getElementById("submitAPI").innerHTML = "Get Tank Size Suggestion";
        }

    });
    $('#checkRoof').click(function() {
        $('#area')[this.checked ? "show" : "hide"]();
    });


    toMain();
    var mysub1;
    var mytank1;
    var myroof1;
    var peopelNum;
    var nop;
    var areaA = 0;
    var areaB = 0;
    var nameList = [
        'Melbourne','East Melbourne','West Melbourne','St Kilda Road Central','South Wharf','Southbank','Docklands','University Of Melbourne','Footscray','Seddon West','Seddon','Flemington','Kensington','Hotham Hill','North Melbourne','Melbourne University','Carlton','Carlton South','Carlton North','Princes Hill','Fitzroy','Abbotsford','Clifton Hill','Fitzroy North','St Kilda','St Kilda West','St Kilda South','Balaclava','St Kilda East','Brighton Road','Elwood','South Melbourne','Albert Park','Middle Park','Garden City','Port Melbourne','Brooklyn','Maidstone','Kingsville','Tottenham','Kingsville West','West Footscray','Yarraville','Yarraville West','Braybrook','Robinson','Braybrook North','Albion','Sunshine North','Glengala','Sunshine West','Sunshine','Albanvale','Kings Park','Kealba','St Albans','Ardeer','Deer Park East','Burnside','Deer Park ','Burnside Heights','Deer Park North','Cairnlea','Ravenhall','Caroline Springs','Ascot Vale','Maribyrnong','Highpoint City','Travancore','Keilor East','Avondale Heights','Keilor','Keilor North','Calder Park','Sydenham','Delahey','Taylors Hill','Hillside','Keilor Downs','Taylors Lakes','Keilor Lodge','Watergardens','Greenvale','Oaklands Junction','Yuroke','Plumpton','Rockbank','Kurunjang','Melton West','Melton','Toolern Vale','Brookfield','Eynesbury','Exford','Melton South','Diggers Rest','Bulla','Sunbury','Wildwood','Newport','Spotwood','South Kingsville','Williamstown','Williamstown North','Altona','Seaholme','Mambourin','Wyndham Vale','Mount Cottrell','Altona East','Altona North','Altona Gate','Laverton North','Williams Landing','Altona Meadows','Seabrook','Laverton','Hoppers Crossing','Truganina','Tarneit','Cocoroc','Quandong','Derrimut','Werribee','Point Cook','Werribee South','Little River','Moonee Ponds','Aberfeldie','Essendon West','Essendon','Essendon Fields','Strathmore','Essendon North','Strathmore Heights','Airport West','Niddrie','Keilor Park','Gladstone Park','Tullamarine','Gowanbrae','Pascoe Vale','Pascoe Vale South','Glenroy','Oak Park','Hadfield','Broadmeadows','Jacana','Dallas','Coolaroo','Meadow Heights','Attwood','Westmeadows','Brunswick South','Moonee Vale','Brunswick West','Moreland West','Brunswick','Brunswick North','Brunswick Lower','Brunswick East','Sumner','Batman','Merlynston','Coburg','Moreland','Coburg North','Fawkner','Campbellfield','Somerton','Craigieburn','Mickleham','Donnybrook','Roxburgh Park','Kalkallo','Northcote','Northcote South','Thornbury','Gilberton','Preston South','Northland Centre','Preston West','Preston','Regent West','Preston Lower','Reservoir','Thomastown','Lalor','Epping','Alphington','Fairfield','Ivanhoe','Ivanhoe North','Ivanhoe East','Bellfield','Heidelberg Rgh','Heidelberg Heights','Heidelberg West','Mill Park','Bundoora','La Trobe University','Kingsbury','Banyule','Rosanna','Eaglemont','Viewbank','Heidelberg','Macleod','Yallambie','Macleod West','Macleod','Briar Hill','St Helena','Greensborough','Diamond Creek','Plenty','Yarrambat','Lower Plenty','Montmorency','Eltham','Resarch','Eltham North','Wattle Glen','Arthurs Creek','Nutfield','Cottles Bridge','Strathewen','Hurstbrdge','Wollert','Woodstock','South Morang','Beveridge','Yan Yean','Eden Park','Kinglake West','Humevale','Pheasant Creek','Kinglake Central','Whittlesea','Bend Of Islands','Watsons Creek','Kangaroo Ground','Donvale','North Warrandyte','Warrandyte','Park Orchards','Wonga Park','Chirnside Park','Brentford Square','Nunawading','Forest Hill','Mitcham','Rangeview','Mitcham North','Vermont','Vermont South','Heathwood','Warrandyte South','Ringwood','Warranwood','Ringwood North','Bedford Road','Ringwood East','Heathmont','Croydon','Croydon North','Croydon Hills','Croydon South','Kilsyth','Kilsyth South','Mooroolbark','Beenak','Seville East','Don Valley','Wandin East','Hoddles Creek','Wandin North','Launching Place','Woori Yallock','Seville ','Yellingbo','Lilydale','Brandon Park','Wheelers Hill','Glen Waverley','Burwood East','Burwood Heights','Knox City Centre','Wantirna','Studfield','Wantirna South','Bayswater','Bayswater North','The Basin','Boronia','Ferntree Gully','Mountain Gate','Lysterfield','Upper Ferntree Gully','Lysterfield South','Upwey','Menzies Creek','Selby','Belgrave','Belgrave South','Belgrave Heights','Tecoma','Rowville','Scoresby','Knoxfield','Panton Hill','Smiths Gully','St Andrews','Kinglake','Montrose','Kalorama','Mount Dandenong','Coldstream','Yering','Gruyere','Christmas Hills','Tarrawarra','Dixons Creek','Yarra Glen','Steels Creek','Badger Creek','Healesville Main Street','Castella','Healesville Post Shop','Chum Creek','Mount Toolebewong','Healesville','Toolangi','Tremont','Ferny Creek','Sassafras','Sassafras Gully','Olinda','Sherbrooke','Kallista','The Patch','Monbulk','Silvan','Mount Evelyn','Gilderoy','Three Bridges','Gladysdale','Yarra Junction','Powelltown','Narre Warren East','Narre Warren North','Cotham','Kew','Kew East','Balwyn','Deepdene','Balwyn East','Balwyn North','Greythorn','Bulleen','Templestowe','Templestowe Lower','Doncaster','Doncaster East','The Pines','Doncaster Heights','Burnley','Richmond East','Burnley North','Richmond North','Cremorne','Richmond South','Richmond','Auburn South','Hawthorn North','Glenferrie South','Hawthorn West','Hawthorn','Auburn','Hawthorn East','Camberwell','Camberwell West','Camberwell North','Hartwell','Camberwell South','Middle Camberwell','Camberwell East','Canterbury','Box Hill','Houston','Box Hill Central','Wattle Park','Box Hill South','Box Hill North','Mont Albert North','Kerrimuir','Blackburn','Blackburn South','Blackburn North','Laburnum','South Yarra','Hawksburn','Toorak','Armadale','Armadale North','Kooyong','Malvern North','Malvern','Caulfield East','Darling South','Central Park','Malvern East','Darling','Wattletree Road Po','Caulfield Junction','Caulfield North','Prahran','Windsor','Prahran East','Caulfield','Hopetoun Gardens','Caulfield South','Glen Huntly','Carnegie','Murrumbeena','Bentleigh East','Hughesdale','Oakleigh South','Clayton','Notting Hill','Clarinda','Clayton South','Dingley Village','Springvale South','Keysborough','Elsternwick','Ripponlea','Gardenvale','Brighton','Dendy','Brighton North','Were Street Po','Brighton East','North Road','Hampton','Hampton North','Hampton East','Moorabbin','Wishart','Moorabbin East','Highett','Sandringham','Cheltenham','Southland Centre','Chetenham East','Beaumaris','Black Rock North','Black Rock','Cromer','Mentone','Moorabbin Airport','Mentone East','Aspendale','Mordialloc','Aspendale Gardens','Parkdale','Braeside','Waterways','Bonbeach','Chelsea Heights','Chelsea','Edithvale','Carrum','Patterson Lakes','Heatherton','Bentleigh','Ormond','Mckinnon','Patterson','Monash University','Mulgrave','Waverley Gardens','Sandown Village','Springvale','Noble Park','Noble Park North','Bangholme','Dandenong North','Dandenong','Dandenong South','Dandenong East','Dunearn','Doveton','Eumemmerring','Cockatoo','Nangana','Mount Burnett','Avonsleigh','Emerald','Clematis','Macclesfield','Gembrook','Endeavour Hills','Hallam','Fountain Gate','Narre Warren South','Narre Warren','Berwick','Harkaway','Beaconsfield','Guys Hill','Beaconsfield Upper','Dewhurst','Officer','Officer South','Pakenham','Pakenham Upper','Pakenham South','Rythdale','Maryknoll','Nar Nar Goon North','Nar Nar Goon','Tynong','Tynong North','Cora Lynn','Garfield North','Garfield','Vervale','Bunyip','Iona','Bunyip North','Tonimbuk','Lynbrook','Lyndhurst','Hampton Park','Botanic Ridge','Cranbourne West','Cannons Creek','Devon Meadows','Cranbourne','Junction Village','Cranbourne East','Sandhurst','Cranbourne North','Skye','Cranbourne South','Cardinia','Clyde North','Clyde','Blind Bight','Warneet','Tooradin','Bayles','Koo Wee Rup','Catani','Koo Wee Rup North','Dalmore','Yannathan','Heath Hill'];
    $("#localization").typeahead({
        source: nameList
    });



    function getpostCode()
    {
        $.ajax({
            type: "POST",
            url: "http://api.usewaterwisely.tk/api/searchlocation",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(GetJsonData()),
            dataType: "json",
            //jsonpCallback: "jsonpcallback",
            async: false,
            success: function(data)
            {
                if(data.locations == null || attributeCount(data.locations) == 0)
                    alert("Warning: Please input valid suburb name");
                else
                {
                    for (var y in data.locations)
                    {
                        var id = data.locations[y];
                        $("#postCode").val(id);
                        return false;
                    }
                }
            },
            error: function (message) {
                alert("error.");
            }
        });
    }
    function localizationChange()
    {
        var loc = $("#localization").val();
        $.ajax({
            type: "POST",
            url: "//TODO",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(GetJsonData()),
            dataType: "json",
            //jsonpCallback: "jsonpcallback",
            async: false,
            success: function(data)
            {
                nameList = data;
            },
            error: function (message) {
            }
        });
    }
    function attributeCount(obj) {
        var count = 0;
        for(var i in obj) {
            if(obj.hasOwnProperty(i))
            {
                count++;
            }
        }
        return count;
    }
    var allText;
    var allTanks;
    var gauge;
    var gauge11;
    var gauge22;
    var gauge33;
    function submitAll()
    {



        if(!$('#checkTank').is(':checked'))
        {
            document.getElementById("waterLitre").value = 0;
        }

        document.getElementById("waterLitre").onchange = "addTank()";
        document.getElementById("area").onchange = "addRoof()";
        $("#localization").blur();
        $("#waterLitre").blur();
        $("#area").blur();
        $("#peopelNum").blur();
        if ($("#localization").hasClass("invalid"))
        {
            alert("Warning: Please input a valid suburb")
            return false;
        }
        if ($("#postCode").hasClass("invalid"))
        {
            alert("Warning: Please input a valid postCode")
            return false;
        }
        if ($("#localization").val() != '' && $("#localization").val() != null && $("#localization").val().length < 3)
        {
            alert("Warning: Input at least 3 letters for location search");
            return false;
        }
        if ($("#waterLitre").val() != '' && $("#waterLitre").val() != null && $("#waterLitre").val() > 50000)
        {
            alert("Warning: The maximum tank capacity is 50000, please check!");
            return false;
        }
        if ($("#waterLitre").val() != '' && $("#waterLitre").val() != null && $("#waterLitre").val() < 1000 && $('#checkTank').is(':checked'))
        {
            alert("Warning: The minimum tank capacity is 1000, please check!");
            return false;
        }
        if ($("#area").val() != '' && $("#area").val() != null && $("#area").val() > 10000)
        {
            alert("Warning: The maximum roof area is 10000 square meter");
            return false;
        }
        if ($("#area").val() != '' && $("#area").val() != null && $("#area").val() < 50 )
        {
            alert("Warning: The minimum roof area is 50 square meter");
            return false;
        }
        if (!$("#waterLitre").hasClass("haveTank") && $("#waterLitre").val() == '')
        {
            alert("Warning: Type in a valid tank size.If you have no tank, uncheck the tank option");
            return false;
        }
        if (!$("#area").hasClass("haveRoof") && $("#area").val() == '')
        {
            alert("Warning: Type in a valid number. If you do not know your roof area, click on 'Calculate My Roof'");
            return false;
        }
        if ($("#waterLitre").hasClass("invalid") || $("#area").hasClass("invalid"))
        {
            alert("Warning: Please input only numbers")
            return false;
        }
        if ($("#peopelNum").hasClass("invalid"))
        {
            alert("Warning : Please tell us the number of people in your house. Max number is 15");
            return false;
        }
        var tankvalue =$("#waterLitre").val();

        $("#mainText").html("");
        $("#mainText").append('<a href="Template-FAQ/index.html" target="_blank"><button type="button" class="btn btn-default btn-info" id="tomail" style="border-radius: 0px;float:right;margin-top: 25px;">FAQ</button></a>');
        if(tankvalue != '')
        {
            }
        if($('#checkTank').is(":checked")) {

            document.getElementById("showResult").style.display="block";
            document.getElementById("part1").style.display="block";
            document.getElementById("part2").style.display="block";
            document.getElementById("part3").style.display="block";
            document.getElementById("part4").style.display="none";
            document.getElementById("slidePage").style.display="none";


        } else {
            document.getElementById("showResult").style.display="block";
            document.getElementById("part1").style.display="none";
            document.getElementById("part2").style.display="block";
            document.getElementById("part3").style.display="none";
            document.getElementById("part4").style.display="block";
            document.getElementById("slidePage").style.display="none";
        };


        var jsondata = null;
        $.ajax({
            type: "POST",
            url: "http://api.usewaterwisely.tk/api/searchlocation",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(GetJsonData()),
            dataType: "json",
            //jsonpCallback: "jsonpcallback",
            async: false,
            success: function(data)
            {
                if(data.locations == null || attributeCount(data.locations) == 0)
                    alert("Warning: Please input valid suburb name");
                else
                    jsondata = data.locations;
            },
            error: function (message) {
                alert("error.");
            }
        });
        if (jsondata == null)
            return false;
        var nameList = new Array(attributeCount(jsondata));
        var numList = new Array(attributeCount(jsondata));
        var cont = 0;
        for (var x in jsondata)
        {
            nameList[cont] = x;
            cont++;
        }
        cont = 0;
        var countNum = 0;
        for (var y in jsondata)
        {
            var id = jsondata[y];
            var htmlContent = null;
            var tanklat = $("#waterLitre").val();
            if (tanklat != '')
            {
                $.ajax({
                    type: "POST",
                    url: "http://api.usewaterwisely.tk/api/getwaterlevels",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify(getJsonDate2(id, y)),
                    dataType: "json",
                    //jsonpCallback: "jsonpcallback",
                    async: false,
                    success: function(data)
                    {
                        var text = data;
                        allText = data;
                        if( text[0] == null)
                            return false;
                        var rainfall = new Array();
                        var runoff = new Array();
                        var cost = new Array();
                        var cost2 = new Array();
                        var cost3 = new Array();
                        var cost4 = new Array();
                        var tanklat = $("#waterLitre").val();
                        if (tanklat == '' || tanklat == null)
                            tanklat = 0;
                        var tanks = [tanklat, tanklat, tanklat, tanklat, tanklat, tanklat, tanklat, tanklat, tanklat, tanklat, tanklat,tanklat];
                        var roofArea = $("#area").val();
                        if (roofArea == '')
                            roofArea = 200;
                        if (text[0] != null){
                            cost[0] = text[0].volume*2.3932/1000;
                            cost2[0] = text[0].volume*2.5993/1000;cost3[0] = text[0].volume*2.6097/1000;cost4[0]=text[0].volume*1.7058/1000;}
                        if (text[1] != null){
                            cost[1] = text[1].volume*2.3932/1000;
                            cost2[1] = text[1].volume*2.5993/1000;cost3[1] = text[1].volume*2.6097/1000;cost4[1]=text[1].volume*1.7058/1000;}
                        if (text[2] != null){
                            cost[2] = text[2].volume*2.3932/1000;
                            cost2[2] = text[2].volume*2.5993/1000;cost3[2] = text[2].volume*2.6097/1000;cost4[2]=text[2].volume*1.7058/1000;}
                        if (text[3] != null){
                            cost[3] = text[3].volume*2.3932/1000;
                            cost2[3] = text[3].volume*2.5993/1000;cost3[3] = text[3].volume*2.6097/1000;cost4[3]=text[3].volume*1.7058/1000;}
                        if (text[4] != null){
                            cost[4] = text[4].volume*2.3932/1000;
                            cost2[4] = text[4].volume*2.5993/1000;cost3[4] = text[4].volume*2.6097/1000;cost4[4]=text[4].volume*1.7058/1000;}
                        if (text[5] != null){
                            cost[5] = text[5].volume*2.3932/1000;
                            cost2[5] = text[5].volume*2.5993/1000;cost3[5] = text[5].volume*2.6097/1000;cost4[5]=text[5].volume*1.7058/1000;}
                        if (text[6] != null){
                            cost[6] = text[6].volume*2.3932/1000;
                            cost2[6] = text[6].volume*2.5993/1000;cost3[6] = text[6].volume*2.6097/1000;cost4[6]=text[6].volume*1.7058/1000;}
                        if (text[7] != null){
                            cost[7] = text[7].volume*2.3932/1000;
                            cost2[7] = text[7].volume*2.5993/1000;cost3[7] = text[7].volume*2.6097/1000;cost4[7]=text[7].volume*1.7058/1000;}
                        if (text[8] != null){
                            cost[8] = text[8].volume*2.3932/1000;
                            cost2[8] = text[8].volume*2.5993/1000;cost3[8] = text[8].volume*2.6097/1000;cost4[8]=text[8].volume*1.7058/1000;}
                        if (text[9] != null){
                            cost[9] = text[9].volume*2.3932/1000;
                            cost2[9] = text[9].volume*2.5993/1000;cost3[9] = text[9].volume*2.6097/1000;cost4[9]=text[9].volume*1.7058/1000;}
                        if (text[10] != null){
                            cost[10] = text[10].volume*2.3932/1000;
                            cost2[10] = text[10].volume*2.5993/1000;cost3[10] = text[10].volume*2.6097/1000;cost4[10]=text[10].volume*1.7058/1000;}
                        if (text[11] != null){
                            cost[11] = text[11].volume*2.3932/1000;
                            cost2[11] = text[11].volume*2.5993/1000;cost3[11] = text[11].volume*2.6097/1000;cost4[11]=text[11].volume*1.7058/1000;}

                        mysub1 = $("#localization").val();
                        mytank1 = $("#waterLitre").val();
                        myroof1 = $("#area").val();
                        nop = $("#peopelNum").val();

                        //op0
                        // Initialising the dataset and variables
                        var tankLevels = [text[0].volume, text[1].volume, text[2].volume, text[3].volume, text[4].volume, text[5].volume, text[6].volume, text[7].volume, text[8].volume, text[9].volume, text[10].volume, text[11].volume];// tank levels
                        var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                        rainfall = [text[0].rainfall, text[1].rainfall, text[2].rainfall, text[3].rainfall, text[4].rainfall, text[5].rainfall, text[6].rainfall, text[7].rainfall, text[8].rainfall, text[9].rainfall, text[10].rainfall, text[11].rainfall];
                        var demands = [];

                        var tank = tanklat; // maximum size
                        var maxheight = 66;
                        var date = new Date();
                        demands[1] = nop * 9 * 30;
                        demands[2] = nop * 240;
                        demands[3] = 473*3;
                        demands[4] = nop * 140 * 5;
                        demands[5] = 651*4;
                        demands[6] = 670;
                        demands[0] = demands[1] + demands[2] + demands[3] + demands[4] + demands[5] + demands[6];
                        console.log(demands);
                        //var textRounder = function(value){ return Math.round(value);
                        //console.log(curenrentMonth);
                        var security = [];
                        for (var i = 0; i < 12; i++)
                        {
                            if (tankLevels[i] > demands[0]){
                                security[i] = 100;
                            } else
                                security[i] = Math.round(tankLevels[i]/demands[0] * 100);
                        }

                        //window.onload = calculate;
                        //function calculate(){
                            document.getElementById("total").innerHTML = demands[0];
                            document.getElementById("shower").innerHTML = demands[1];
                            document.getElementById("toilet").innerHTML = demands[4];
                            document.getElementById("kitchen").innerHTML = demands[3];
                            document.getElementById("gardening").innerHTML = demands[5];
                            document.getElementById("washing").innerHTML = demands[2];
                            document.getElementById("misc").innerHTML = demands[6];
                       // }
                        var tanksuggestions = [];
                        tanksuggestions[0] = Math.round(demands[0]/500)*500;
                        var max_number = Math.max.apply(Math, tankLevels);
                        tanksuggestions[1] = Math.round(max_number/500)*500;

                        var midpoint = (tanksuggestions[0] + tanksuggestions[1])/2;
                        tanksuggestions[2] = Math.round(midpoint/500)*500;
                        tanksuggestions.sort(function(a, b){return a-b;});



                        $("#chartID").empty();
                        var svg =  new d3.select("#chartID")
                            .append("svg")
                            .attr("height", 420)
                            .attr("width", 1200)
                            .attr("viewBox","0 0 1200 420")
                            .attr("preserveAspectRatio","xMidYMid meet");

                        for (i = 0; i < 12; i++){
                            var xvalue = 100*i - 35,
                                yvalue = 152;
                            svg.append("svg:image")
                                .attr("xlink:href","images/tank1.png")
                                .attr("width", 175)
                                .attr("height", 70)
                                .attr("x", xvalue)
                                .attr("y", yvalue);
                        }

                        for (i = 0; i < 12; i++) {
                            var cloudx = 100 * i - 20,
                                cloudy = 45;
                            if (rainfall[i] < 31) {
                                svg.append("svg:image")
                                    .attr("xlink:href", "images/less_rain.png")
                                    .attr("width", 150)
                                    .attr("height", 80)
                                    .attr("x", cloudx)
                                    .attr("y", cloudy);
                            }
                            else if (rainfall[i] > 30 && rainfall[i] < 61) {
                                svg.append("svg:image")
                                    .attr("xlink:href", "images/heavy_rain.png")
                                    .attr("width", 150)
                                    .attr("height", 80)
                                    .attr("x", cloudx)
                                    .attr("y", cloudy);
                            }
                            else {
                                svg.append("svg:image")
                                    .attr("xlink:href", "images/dark_cloud.png")
                                    .attr("width", 150)
                                    .attr("height", 80)
                                    .attr("x", cloudx)
                                    .attr("y", cloudy);
                            }

                        }

                        for (i = 0; i < 12; i++) {
                            if (tankLevels[i] > tank) {
                                var overflowx = 100 * i - 45,
                                    overflowy = 245;
                                svg.append("svg:image")
                                    .attr("xlink:href", "images/overflow.jpg")
                                    .attr("width", 175)
                                    .attr("height", 60)
                                    .attr("x", overflowx)
                                    .attr("y", overflowy);
                            }
                        }


                        svg.selectAll("rect")
                            .data(tankLevels)
                            .enter().append("rect")
                            .attr("x",function(d,i){ return 100*i + 20; })
                            .attr("y",function(d,i){
                                if (d > tank){
                                    return 220;
                                } else{
                                    return 220; }})
                            .attr("rx", 5)
                            .attr("ry", 5)
                            .attr("width","65")
                            .transition().delay(function (d,i){ return i*300})
                            .duration(800)
                            .attr("height",function(d){
                                if (d > tank){
                                    return maxheight;}
                                else{
                                    return maxheight * d/tank; }})
                            .attr("y",function(d){
                                if (d > tank){
                                    return 220 - maxheight;
                                } else{
                                    return maxheight - maxheight * d/tank + 154; }})
                            .attr("fill",function(d,i){
                                var currentMonth = date.getMonth();
                                if (i < currentMonth){
                                    return "#87d3ff";
                                }
                                else if (i === currentMonth){
                                    return "#008fff";
                                }
                                else
                                    return "#0068f4";
                            });

                        svg.selectAll("text.months-label")
                            .data(months).enter()
                            .append("text")
                            .attr("class", "months-label")
                            .text(function(d){ return d; })
                            .attr("x", function(d,i){ return 100*i + 50; })
                            .attr("y", 28)
                            .attr("text-anchor", "middle")
                            .attr("font-family", "sans-serif")
                            .attr("font-size", "16px")
                            .attr("fill", "black");

                        svg.selectAll("text.rain-label")
                            .data(rainfall).enter()
                            .append("text")
                            .attr("class", "rain-label")
                            .text(function(d){ return d + "mm"; })
                            .attr("x", function(d,i){ return 100*i + 50; })
                            .attr("y", 90)
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "12px")
                            .attr("fill", "black");

                        svg.selectAll("text.tank-label")
                            .data(tankLevels).enter()
                            .append("text")
                            .attr("class", "tank-label")
                            .text(function(d){
                                var tanklevel = Math.round(d/tank * 100);
                                if (tanklevel > 100){
                                    return 100 + "%"
                                } else {
                                    return tanklevel + "%";}})
                            .attr("x", function(d,i){ return 100*i + 50; })
                            .attr("y", 150)
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "12px")
                            .attr("fill", "black");

                        svg.selectAll("text.overflow-label")
                            .data(tankLevels).enter()
                            .append("text")
                            .attr("class", "overflow-label")
                            .text(function(d){
                                var tanklevel = Math.round(d/tank * 100);
                                if (tanklevel > 100){
                                    return (tanklevel - 100) + "%";
                                } else {
                                    return;}})
                            .attr("x", function(d,i){ return 100*i + 50; })
                            .attr("y", 270)
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "12px")
                            .attr("fill", "black");

                        for (i = 0; i <= 12; i++){
                            var linex = 100*i;
                            if (i == 4 || i == 5){
                                svg.append("line")
                                    .attr("x1", linex)
                                    .attr("y1", 10)
                                    .attr("x2", linex)
                                    .attr("y2", 340)
                                    .attr("stroke-width", 3)
                                    .attr("stroke", "black");
                            }else {
                                svg.append("line")
                                    .attr("x1", linex)
                                    .attr("y1", 10)
                                    .attr("x2", linex)
                                    .attr("y2", 340)
                                    .attr("stroke-width", 1)
                                    .attr("stroke", "grey");
                            }
                        }

                        svg.append("line")
                            .attr("x1", 0)
                            .attr("y1", 10)
                            .attr("x2", 1260)
                            .attr("y2", 10)
                            .attr("stroke-width", 1)
                            .attr("stroke", "grey");

                        svg.append("line")
                            .attr("x1", 0)
                            .attr("y1", 35)
                            .attr("x2", 1260)
                            .attr("y2", 35)
                            .attr("stroke-width", 1)
                            .attr("stroke", "grey");

                        svg.append("line")
                            .attr("x1", 0)
                            .attr("y1", 135)
                            .attr("x2", 1260)
                            .attr("y2", 135)
                            .attr("stroke-width", 1)
                            .attr("stroke", "grey");

                        svg.append("line")
                            .attr("x1", 0)
                            .attr("y1", 240)
                            .attr("x2", 1260)
                            .attr("y2", 240)
                            .attr("stroke-width", 1)
                            .attr("stroke", "grey");

                        svg.append("line")
                            .attr("x1", 0)
                            .attr("y1", 340)
                            .attr("x2", 460)
                            .attr("y2", 340)
                            .attr("stroke-width", 5)
                            .attr("stroke", "#87d2ff");


                        svg.append("line")
                            .attr("x1", 400)
                            .attr("y1", 340)
                            .attr("x2", 500)
                            .attr("y2", 340)
                            .attr("stroke-width", 5)
                            .attr("stroke", "#008fff");

                        svg.append("line")
                            .attr("x1", 500)
                            .attr("y1", 340)
                            .attr("x2", 1200)
                            .attr("y2", 340)
                            .attr("stroke-width", 5)
                            .attr("stroke", "#0068f4");

                        svg.append("text")
                            .attr("x", 200)
                            .attr("y", 330)
                            .text("Historic")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "28px")
                            .attr("fill", "#87d2ff");

                        svg.append("text")
                            .attr("x", 450)
                            .attr("y", 330)
                            .text("Current")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "28px")
                            .attr("fill", "#008fff");

                        svg.append("text")
                            .attr("x", 880)
                            .attr("y", 330)
                            .text("Forecast")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "28px")
                            .attr("fill", "#0068f4");

                        svg.append("svg:image")
                            .attr("xlink:href", "images/heavy_rain.png")
                            .attr("width", 175)
                            .attr("height", 70)
                            .attr("x", 800)
                            .attr("y", 345);

                        svg.append("svg:image")
                            .attr("xlink:href","images/tank1.png")
                            .attr("width", 175)
                            .attr("height", 70)
                            .attr("x", 900)
                            .attr("y", 345);

                        svg.append("svg:image")
                            .attr("xlink:href","images/overflow.jpg")
                            .attr("width", 175)
                            .attr("height", 70)
                            .attr("x", 1000)
                            .attr("y", 345);

                        svg.append("text")
                            .attr("x", 890)
                            .attr("y", 392)
                            .text("Rainfall")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "16px")
                            .attr("fill", "black");

                        svg.append("text")
                            .attr("x", 990)
                            .attr("y", 380)
                            .attr("class", "id")
                            .append("svg:tspan")
                            .attr("x", 990)
                            .attr("dy", 5)
                            .text("Volume")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "16px")
                            .attr("fill", "black")
                            .append("svg:tspan")
                            .attr("x", 990)
                            .attr("dy", 20)
                            .text("full(%)")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "16px")
                            .attr("fill", "black");

                        svg.append("text")
                            .attr("x", 1100)
                            .attr("y", 380)
                            .attr("class", "id")
                            .append("svg:tspan")
                            .attr("x", 1100)
                            .attr("dy", 5)
                            .text("Overflow")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "12px")
                            .attr("fill", "black")
                            .append("svg:tspan")
                            .attr("x", 1100)
                            .attr("dy", 20)
                            .text("volume(%)")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "12px")
                            .attr("fill", "black");

                        $("#securityChart").empty();
                        var svg2 =  d3.select("#securityChart")
                            .append("svg")
                            .attr("height", 250)
                            .attr("width", 1200)
                            .attr("viewBox","0 0 1200 250")
                            .attr("preserveAspectRatio","xMidYMid meet");

                        for (i = 0; i < 12; i++){
                            var xvalue = 100*i - 35,
                                yvalue = 88;
                            svg2.append("svg:image")
                                .attr("xlink:href","images/tank1.png")
                                .attr("width", 175)
                                .attr("height", 70)
                                .attr("x", xvalue)
                                .attr("y", yvalue);
                        }

                        svg2.selectAll("rect")
                            .data(security)
                            .enter().append("rect")
                            .attr("x",function(d,i){ return 100*i + 20; })
                            .attr("y", 160)
                            .attr("rx", 5)
                            .attr("ry", 5)
                            .attr("width","65")
                            .transition().delay(function (d,i){ return i*300})
                            .duration(800)
                            .attr("height",function(d){
                                return maxheight * d/100; })
                            .attr("y",function(d){
                                return maxheight - maxheight * d/100 + 90; })
                            .attr("fill",function(d,i){
                                var currentMonth = date.getMonth();
                                if (i < currentMonth){
                                    return "#87d3ff";
                                }
                                else if (i === currentMonth){
                                    return "#008fff";
                                }
                                else
                                    return "#0068f4";
                            });

                        svg2.selectAll("text.dtank-label")
                            .data(security).enter()
                            .append("text")
                            .attr("class", "dtank-label")
                            .text(function(d) {
                                return d + "%"
                            })
                            .attr("x", function(d,i){ return 100*i + 50; })
                            .attr("y", 80)
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "12px")
                            .attr("fill", "black");


                        svg2.selectAll("text.dmonths-label")
                            .data(months).enter()
                            .append("text")
                            .attr("class", "dmonths-label")
                            .text(function(d){ return d; })
                            .attr("x", function(d,i){ return 100*i + 50; })
                            .attr("y", 40)
                            .attr("text-anchor", "middle")
                            .attr("font-family", "sans-serif")
                            .attr("font-size", "16px")
                            .attr("fill", "black");

                        for (i = 0; i <= 12; i++){
                            var linex = 100*i;
                            if (i == 4 || i == 5){
                                svg2.append("line")
                                    .attr("x1", linex)
                                    .attr("y1", 20)
                                    .attr("x2", linex)
                                    .attr("y2", 200)
                                    .attr("stroke-width", 3)
                                    .attr("stroke", "black");
                            }else {
                                svg2.append("line")
                                    .attr("x1", linex)
                                    .attr("y1", 20)
                                    .attr("x2", linex)
                                    .attr("y2", 200)
                                    .attr("stroke-width", 1)
                                    .attr("stroke", "grey");
                            }
                        }

                        svg2.append("line")
                            .attr("x1", 0)
                            .attr("y1", 50)
                            .attr("x2", 1260)
                            .attr("y2", 50)
                            .attr("stroke-width", 1)
                            .attr("stroke", "grey");

                        svg2.append("line")
                            .attr("x1", 0)
                            .attr("y1", 20)
                            .attr("x2", 1260)
                            .attr("y2", 20)
                            .attr("stroke-width", 1)
                            .attr("stroke", "grey");

                        svg2.append("line")
                            .attr("x1", 0)
                            .attr("y1", 200)
                            .attr("x2", 460)
                            .attr("y2", 200)
                            .attr("stroke-width", 5)
                            .attr("stroke", "#87d2ff");


                        svg2.append("line")
                            .attr("x1", 400)
                            .attr("y1", 200)
                            .attr("x2", 500)
                            .attr("y2", 200)
                            .attr("stroke-width", 5)
                            .attr("stroke", "#008fff");

                        svg2.append("line")
                            .attr("x1", 500)
                            .attr("y1", 200)
                            .attr("x2", 1200)
                            .attr("y2", 200)
                            .attr("stroke-width", 5)
                            .attr("stroke", "#0068f4");

                        svg2.append("text")
                            .attr("x", 200)
                            .attr("y", 190)
                            .text("Historic")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "28px")
                            .attr("fill", "#87d2ff");

                        svg2.append("text")
                            .attr("x", 450)
                            .attr("y", 190)
                            .text("Current")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "28px")
                            .attr("fill", "#008fff");

                        svg2.append("text")
                            .attr("x", 880)
                            .attr("y", 190)
                            .text("Forecast")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "28px")
                            .attr("fill", "#0068f4");

                        for (i = 0; i < 12; i++){
                            xvalue = 100*i - 35,
                                yvalue = 95;
                            svg2.append("svg:image")
                                .attr("xlink:href","images/demand_drop.png")
                                .attr("width", 175)
                                .attr("height", 55)
                                .attr("x", xvalue)
                                .attr("y", yvalue);
                        }

                        $("#suggestionChart").empty();
                        var svg1 =  new d3.select("#suggestionChart")
                            .append("svg")
                            .attr("height", 200)
                            .attr("width", 1200)
                            .attr("viewBox","0 0 1200 200")
                            .attr("preserveAspectRatio","xMidYMid meet");

                        svg1.append("svg:image")
                            .attr("xlink:href", "images/small.png")
                            .attr("width", 175)
                            .attr("height", 70)
                            .attr("x", 100)
                            .attr("y", 110);

                        svg1.append("svg:image")
                            .attr("xlink:href", "images/medium.png")
                            .attr("width", 200)
                            .attr("height", 100)
                            .attr("x", 300)
                            .attr("y", 80);

                        svg1.append("svg:image")
                            .attr("xlink:href", "images/large_tank.png")
                            .attr("width", 250)
                            .attr("height", 120)
                            .attr("x", 550)
                            .attr("y", 60);

                        svg1.append("line")
                            .attr("x1", 80)
                            .attr("y1", 180)
                            .attr("x2", 800)
                            .attr("y2", 180)
                            .attr("stroke-width", 4)
                            .attr("stroke", "grey");

                        svg1.append("text")
                            .attr("x", 180)
                            .attr("y", 144)
                            .text("Small")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "18px")
                            .attr("fill", "black");

                        svg1.append("text")
                            .attr("x", 392)
                            .attr("y", 146)
                            .text("Medium")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "20px")
                            .attr("fill", "black");

                        svg1.append("text")
                            .attr("x", 665)
                            .attr("y", 140)
                            .text("Large")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "22px")
                            .attr("fill", "black");

                        svg1.append("text")
                            .attr("x", 665)
                            .attr("y", 60)
                            .text(tanksuggestions[2] + " L")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "22px")
                            .attr("fill", "black");

                        svg1.append("text")
                            .attr("x", 392)
                            .attr("y", 80)
                            .text(tanksuggestions[1] + " L")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "20px")
                            .attr("fill", "black");

                        svg1.append("text")
                            .attr("x", 180)
                            .attr("y", 110)
                            .text(tanksuggestions[0] + " L")
                            .attr("text-anchor", "middle")
                            .attr("font-family", "san-serif")
                            .attr("font-size", "18px")
                            .attr("fill", "black");
                        // table legend
                        //op1
                        $("#main_"+countNum).append('<svg id="fillgauge'+countNum+'" width="30%" height="150" style="float: left;"></svg>');
                        $("#main_"+countNum).append('<div id="inTge" style="float:left;border:1px solid blue;width:250px;height:150px"></div>');
                        $("#inTge").append('<div id="volumeTag" style="margin-top: 30px;margin-left: 15px;">Tank overflow:</div><br>');
                        $("#inTge").append('<div id="overflowss" style="margin-left: 15px; color:red"></div>');
                        $("#inTge").append('<div id="fill" style="margin-left: 15px; color:red"></div>');
                        $("#inTge").append('<div id="deficitTag" style="margin-left: 15px;">Deficit:</div>');
                        $("#main_"+countNum).append('<br><br><br><br><br><br><br><div id = "word" style="margin-top: 20px; margin-left: 40px; font-size : 15px">Click on these button to switch month</div>');
                        $("#main_"+countNum).append('<br><div id="buttonList" style="margin-top: 0px;margin-left: 40px;"></div>');
                        for (var is = 0; is < 12; is++)
                        {
                            var mon = "";
                            if(is == 0)
                            {
                                mon = "Jan"
                            }
                            if(is == 1)
                            {
                                mon = "Feb"
                            }
                            if(is == 2)
                            {
                                mon = "Mar"
                            }
                            if(is == 3)
                            {
                                mon = "Apr"
                            }
                            if(is == 4)
                            {
                                mon = "May"
                            }
                            if(is == 5)
                            {
                                mon = "Jun"
                            }
                            if(is == 6)
                            {
                                mon = "Jul"
                            }
                            if(is == 7)
                            {
                                mon = "Aug"
                            }
                            if(is == 8)
                            {
                                mon = "Sep"
                            }
                            if(is == 9)
                            {
                                mon = "Oct"
                            }
                            if(is == 10)
                            {
                                mon = "Nov"
                            }
                            if(is == 11)
                            {
                                mon = "Dec"
                            }
                            }



                        countNum++;
                        //op2
                        var options2 = {
                            color: ['#1f2d53','#3398DB','#43AC6A','#EA2F10'],
                            title: {
                                text: 'Cost chart\n -' +  nameList[cont],
                                textStyle: {fontSize:12}
                            },
                            tooltip: {},
                            legend: {
                                right: 20,

                                data:['City West Water', 'Yarra Valley Water', 'South East Water', 'Western Water']
                            },
                            grid: { // control the size of charts
                                x: 100,
                                y:100,
                                x2: 100,
                                y2: 100,
                            },
                            xAxis: {
                                name:'Month',
                                data: ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]
                            },
                            yAxis: {name:'Dolars'},
                            series: [{
                                name: 'City West Water',
                                type: 'bar',
                                data: cost
                            },
                                {
                                    name: 'Yarra Valley Water',
                                    type: 'bar',
                                    data: cost2
                                },
                                {
                                    name: 'South East Water',
                                    type: 'bar',
                                    data: cost3
                                },
                                {
                                    name: 'Western Water',
                                    type: 'bar',
                                    data: cost4
                                }
                            ]
                        };
                        countNum++;
                        //op3
                        $.ajax({
                            type: "POST",
                            url: "http://api.usewaterwisely.tk/api/gettanksize",
                            contentType: "application/json; charset=utf-8",
                            data: JSON.stringify(gettanksize(id, y)),
                            dataType: "json",
                            //jsonpCallback: "jsonpcallback",
                            async: false,
                            success: function(data)
                            {
                                var jsonStr = data;
                                allTanks = data;

                                peopelNum = $("#peopelNum").val();
                                if (peopelNum == '')
                                    peopelNum = 1;

                                $("#main_0").append('<div id="bolls" style="margin-top:30px"></div>');
                                $("#bolls").append('<svg id="fillgaugeb1" width="25%" height="120" style="float: left;"></svg>');
                                $("#bolls").append('<span style="float: left;margin-left:-30px">tank size:<br>'+jsonStr.tank_size+ " Litres"+'</span>');
                                $("#bolls").append('<svg id="fillgaugeb2" width="25%" height="120" style="float: left;"></svg>');
                                $("#bolls").append('<span style="float: left;margin-left:-30px">tank size:<br>'+(jsonStr.tank_size + peopelNum*120)+ " Litres"+'</span>');
                                $("#bolls").append('<svg id="fillgaugeb3" width="25%" height="120" style="float: left;"></svg>');
                                $("#bolls").append('<span id="finaTankSize" style="float: left;margin-left:-30px">tank size:<br>'+(jsonStr.tank_size+5000)+ " Litres"+'</span>');
                                $("#bolls").append('<br><br><br><br><br><br><div id = "word" style="margin-top: 15px; margin-left:40px;font-size : 15px">Click on these button to switch month</div>');
                                $("#bolls").append('<br><div id="buttonList2" style="margin-top: 0px;margin-left: 40px;"></div>');
                                for (var is = 0; is < 12; is++)
                                {
                                    var mon = "";
                                    if(is == 0)
                                    {
                                        mon = "Jan"
                                    }
                                    if(is == 1)
                                    {
                                        mon = "Feb"
                                    }
                                    if(is == 2)
                                    {
                                        mon = "Mar"
                                    }
                                    if(is == 3)
                                    {
                                        mon = "Apr"
                                    }
                                    if(is == 4)
                                    {
                                        mon = "May"
                                    }
                                    if(is == 5)
                                    {
                                        mon = "Jun"
                                    }
                                    if(is == 6)
                                    {
                                        mon = "Jul"
                                    }
                                    if(is == 7)
                                    {
                                        mon = "Aug"
                                    }
                                    if(is == 8)
                                    {
                                        mon = "Sep"
                                    }
                                    if(is == 9)
                                    {
                                        mon = "Oct"
                                    }
                                    if(is == 10)
                                    {
                                        mon = "Nov"
                                    }
                                    if(is == 11)
                                    {
                                        mon = "Dec"
                                    }
                                    $("#buttonList2").append('<button class="btn btn-default btn-primary" type="button" style="margin-left: 10px; font-size: 10px" onclick="changeTankMonth('+is+')">'+ mon +'</button>');
                                }



                            },
                            error: function (message) {
                            }
                        });
                    },
                    error: function (message) {
                        htmlContent = message;
                    }
                });
            }
            else
            {
                $.ajax({
                    type: "POST",
                    url: "http://api.usewaterwisely.tk/api/gettanksize",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify(gettanksize(id, y)),
                    dataType: "json",
                    //jsonpCallback: "jsonpcallback",
                    async: false,
                    success: function(data)
                    {
                        var peopelNum = $("#peopelNum").val();
                        if (peopelNum == '')
                            peopelNum = 1;
                        $("#mainText").append('<div id="main_01" style="height:450px;"></div>');
                        var jsonStr = data;
                        allTanks = data;
                        $("#main_01").append('<br><div id = "word" style="margin-top: 15px; margin-left:40px;font-size : 15px">These bubbles show the tank suggestions that based on your roof area and house holder numbers. The water level shows the quantity of water you can collect in your tank for each month</div>');
                        $("#main_01").append('<div id="bolls" style="margin-top:50px"></div>');

                        $("#bolls").append('<svg id="fillgaugeb1" width="25%" height="120" style="float: left;"></svg>');
                        $("#bolls").append('<span style="float: left;margin-left:-30px">tank size:<br>'+jsonStr.tank_size+'</span>');
                        $("#bolls").append('<svg id="fillgaugeb2" width="25%" height="120" style="float: left;"></svg>');
                        $("#bolls").append('<span style="float: left;margin-left:-30px">tank size:<br>'+(jsonStr.tank_size + peopelNum*120)+'</span>');
                        $("#bolls").append('<svg id="fillgaugeb3" width="25%" height="120" style="float: left;"></svg>');
                        $("#bolls").append('<span id="finaTankSize" style="float: left;margin-left:-30px">tank size:<br>'+(jsonStr.tank_size+5000)+'</span>');
                        $("#bolls").append('<br><br><br><br><br><br><div id = "word" style="margin-top: 15px; margin-left:40px;font-size : 15px">Click on these button to switch month</div>');
                        $("#bolls").append('<br><div id="buttonList2" style="margin-top: 0px;margin-left: 40px;"></div>');
                        for (var is = 0; is < 12; is++)
                        {
                            var mon = "";
                            if(is == 0)
                            {
                                mon = "Jan"
                            }
                            if(is == 1)
                            {
                                mon = "Feb"
                            }
                            if(is == 2)
                            {
                                mon = "Mar"
                            }
                            if(is == 3)
                            {
                                mon = "Apr"
                            }
                            if(is == 4)
                            {
                                mon = "May"
                            }
                            if(is == 5)
                            {
                                mon = "Jun"
                            }
                            if(is == 6)
                            {
                                mon = "Jul"
                            }
                            if(is == 7)
                            {
                                mon = "Aug"
                            }
                            if(is == 8)
                            {
                                mon = "Sep"
                            }
                            if(is == 9)
                            {
                                mon = "Oct"
                            }
                            if(is == 10)
                            {
                                mon = "Nov"
                            }
                            if(is == 11)
                            {
                                mon = "Dec"
                            }
                            $("#buttonList2").append('<button class="btn btn-default btn-primary" type="button" style="margin-left: 10px; font-size: 10px" onclick="changeTankMonth('+is+')">'+ mon +'</button>');
                        }


                        $.ajax({
                            type: "POST",
                            url: "http://api.usewaterwisely.tk/api/getwaterlevels",
                            contentType: "application/json; charset=utf-8",
                            data: JSON.stringify(gettanksize2(id, y, jsonStr.tank_size)),
                            dataType: "json",
                            //jsonpCallback: "jsonpcallback",
                            async: false,
                            success: function(data)
                            {
                                var text = data;
                                allText = data;
                                changeTankMonth(0);
                            },
                            error: function (message) {
                            }
                        });
                    },
                    error: function (message) {
                    }
                });
            }

            toMain();
            cont++
            return;
        }

    }

    function gettanksize(id, val)
    {
        var strr = ""+id;
        var strrSub = ""+val
        var roofArea = $("#area").val();
        if (roofArea == '')
            roofArea = '200';
        var peopelNum = $("#peopelNum").val();
        if (peopelNum == '')
            peopelNum = '1';
        var json = {
            "code":strr,
            "suburb":strrSub,
            "roof_area" : roofArea,
            "household_number": peopelNum
        };
        return json;
    }
    function gettanksize2(id, val, tanksize)
    {
        var strr = ""+id;
        var strrSub = ""+val
        var roofArea = $("#area").val();
        if (roofArea == '')
            roofArea = '200';
        var peopelNum = $("#peopelNum").val();
        if (peopelNum == '')
            peopelNum = '1';
        var json = {
            "code":strr,
            "suburb":strrSub,
            "roof_area" : roofArea,
            "household_number": peopelNum,
            "tank_capacity": tanksize
        };
        return json;
    }
    function getJsonDate2(id, val)
    {
        var strr = ""+id;
        var strrSub = ""+val
        var roofArea = $("#area").val();
        if (roofArea == '')
            roofArea = '200';
        var peopelNum = $("#peopelNum").val();
        if (peopelNum == '')
            peopelNum = '1';
        var tank = $("#waterLitre").val();
        if (tank == '')
            tank = null;
        if (tank != null)
        {
            var json = {
                "code":strr,
                "suburb":strrSub,
                "roof_area" : roofArea,
                "household_number": peopelNum,
                "tank_capacity": tank
            };
            return json;
        }
        else
        {
            var json = {
                "code":strr,
                "suburb":strrSub,
                "roof_area" : roofArea,
                "household_number": peopelNum
            };
            return json;
        }

    }

    function toMain()
    {
        $(".rainfall2").show();
        $(".rainfall").hide();
        $(".costchat").hide();
        $("#toMain").addClass("btn-primary");
        $("#toMain").addClass("active");
        $("#toCost").removeClass("btn-primary");
        $("#toCost").removeClass("active");
    }
    function toCost()
    {
        $(".rainfall2").hide();
        $(".rainfall").hide();
        $(".costchat").show();
        $("#toMain").removeClass("btn-primary");
        $("#toMain").removeClass("active");
        $("#toCost").addClass("btn-primary");
        $("#toCost").addClass("active");
    }


    $("#localization").blur(
        function(){
            var varText = $("#localization").val();
            if(/^[A-Za-z ]+$/.test(varText))
            {
                $("#localization").css("background-color", "white");
                $("#localization").removeClass("invalid");
            }
            else
            {
                $("#localization").css("background-color", "#FFE1E1");
                $("#localization").addClass("invalid");
            }
        });

    $("#area").blur(
        function(){
            var varText = $("#area").val();
            if(!/^[A-Za-z ]+$/.test(varText))
            {
                $("#area").css("background-color", "white");
                $("#area").removeClass("invalid");
            }
            else
            {
                $("#area").css("background-color", "#FFE1E1");
                $("#area").addClass("invalid");
            }
        });

    $("#waterLitre").blur(
        function(){
            var varText = $("#waterLitre").val();
            if(!/^[A-Za-z ]+$/.test(varText))
            {
                $("#waterLitre").css("background-color", "white");
                $("#waterLitre").removeClass("invalid");
            }
            else
            {
                $("#waterLitre").css("background-color", "#FFE1E1");
                $("#waterLitre").addClass("invalid");
            }
        });





    $("#peopelNum").blur(
        function(){
            var varText = $("#peopelNum").val();
            if(/^[0-9]+$/.test(varText))
            {
                if (varText > 15 || varText < 1)
                {
                    $("#peopelNum").css("background-color", "#FFE1E1");
                    $("#peopelNum").addClass("invalid");
                }
                else
                {
                    $("#peopelNum").css("background-color", "white");
                    $("#peopelNum").removeClass("invalid");
                }
            }
            else
            {
                $("#peopelNum").css("background-color", "#FFE1E1");
                $("#peopelNum").addClass("invalid");
            }
        });


    function addTank()
    {
        $("#waterLitre").addClass("haveTank")
        notank();

    }
    function removeTank()
    {
        document.getElementById('tank1').style.display = 'none';
        $("#waterLitre").removeClass("haveTank")
        notank();
    }
    function notank(obj)
    {
        if(!$("#waterLitre").hasClass("haveTank"))
        {
            $("#waterLitre").val("");
            $("#waterLitre").css("background-color", "white");
            $("#waterLitre").removeClass("invalid");
            $("#waterLitre").addClass("haveTank");
            $("#waterLitre").attr("disabled",true);
            $(obj).text("Have Tank");
        }
        else
        {
            $("#waterLitre").val("");
            $("#waterLitre").css("background-color", "white");
            $("#waterLitre").removeClass("invalid");
            $("#waterLitre").removeClass("haveTank");
            $("#waterLitre").attr("disabled",false);
            $(obj).text("No Tank");
        }
    }

    function addRoof()
    {
        $("#area").addClass("haveRoof")
        noRoof();
    }
    function removeRoof()
    {
        $("#area").removeClass("haveRoof")
        noRoof();
    }
    function noRoof(obj)
    {
        if(!$("#area").hasClass("haveRoof"))
        {
            $("#area").val("");
            $("#area").css("background-color", "white");
            $("#area").removeClass("invalid");
            $("#area").addClass("haveRoof");
            $("#area").attr("disabled",true);
            $(obj).text("Know Roof Area");
        }
        else
        {
            $("#area").val("");
            $("#area").css("background-color", "white");
            $("#area").removeClass("invalid");
            $("#area").removeClass("haveRoof");
            $("#area").attr("disabled",false);
            $(obj).text("Dont Know Roof Area");
        }
    }

    function GetJsonData() {
        var localization = $("#localization").val();
        var json = {
            "location": localization
        };
        return json;
    }

    /**
     * Created by Administrator on 2017/5/7.
     */

    var drawingManager;
    var selectedShape;


    function clearSelection() {
        if (selectedShape) {
            selectedShape.setEditable(false);
            selectedShape = null;
        }
    }
    function setSelection(shape) {
        clearSelection();
        selectedShape = shape;
        shape.setEditable(true);
        google.maps.event.addListener(shape.getPath(), 'set_at', calcar);
        google.maps.event.addListener(shape.getPath(), 'insert_at', calcar);
    }

    function calcar() {
        var areaB = google.maps.geometry.spherical.computeArea(selectedShape.getPath());
        document.getElementById("areaB").innerHTML = "Your roof area is " + areaB.toFixed(0) + " m&sup2";
        areaA = areaB.toFixed(0);
    }
    function deleteSelectedShape() {
        if (selectedShape) {
            selectedShape.setMap(null);
            areaA = 0;
            areaB = 0;
            document.getElementById("areaB").innerHTML = "Your roof area is " + areaB.toFixed(0) + " m&sup2";
        }
        else
        {
            calroof();
        }
    }

    function deleteAllShape() {
        for (var i=0; i < all_overlays.length; i++)
        {
            all_overlays[i].overlay.setMap(null);
        }
        all_overlays = [];
    }

    var infoWindow = new google.maps.InfoWindow;

    function initialize() {


        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 18,
            center: new google.maps.LatLng(-37.8770, 145.0443),
            mapTypeId: 'satellite',
            disableDefaultUI: true,
            zoomControl: true,
            mapTypeControl: true,
            drawingControl: true
        });




        var infoWindow = new google.maps.InfoWindow({map: map});

// Try HTML5 geolocation.
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };

                infoWindow.setPosition(pos);
                infoWindow.setContent('Location found.');
                map.setCenter(pos);
            }, function() {
                handleLocationError(true, infoWindow, map.getCenter());
            });
        } else {
            // Browser doesn't support Geolocation
            handleLocationError(false, infoWindow, map.getCenter());
        }

        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
            infoWindow.setPosition(pos);
            infoWindow.setContent(browserHasGeolocation ?
                'Error: The Geolocation service failed.' :
                'Error: Your browser doesn\'t support geolocation.');
        }

// Create the search box and link it to the UI element.
        var input = document.getElementById('pac-input');
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener('bounds_changed', function() {
            searchBox.setBounds(map.getBounds());
        });

        var markers = [];
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
        searchBox.addListener('places_changed', function() {
            var places = searchBox.getPlaces();

            if (places.length == 0) {
                return;
            }

            // Clear out the old markers.
            markers.forEach(function(marker) {
                marker.setMap(null);
            });
            markers = [];

            // For each place, get the icon, name and location.
            var bounds = new google.maps.LatLngBounds();
            places.forEach(function(place) {
                if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                }
                var icon = {
                    url: place.icon,
                    size: new google.maps.Size(71, 71),
                    origin: new google.maps.Point(0, 0),
                    anchor: new google.maps.Point(17, 34),
                    scaledSize: new google.maps.Size(25, 25)
                };

                // Create a marker for each place.
                markers.push(new google.maps.Marker({
                    map: map,
                    icon: icon,
                    title: place.name,
                    position: place.geometry.location
                }));

                if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                } else {
                    bounds.extend(place.geometry.location);
                }
            });
            map.fitBounds(bounds);
        });


        var polyOptions = {
            strokeWeight: 0,
            fillOpacity: 0.45,
            editable: true
        };
        // Creates a drawing manager attached to the map that allows the user to draw
        // markers, lines, and shapes.
        drawingManager = new google.maps.drawing.DrawingManager({
            drawingMode: google.maps.drawing.OverlayType.POLYGON,
            drawingControlOptions: {
                position: google.maps.ControlPosition.TOP_RIGHT,
                drawingModes: ['marker', 'polygon'],
            },
            markerOptions: {
                draggable: true
            },
            polylineOptions: {
                editable: true
            },
            rectangleOptions: polyOptions,
            circleOptions: polyOptions,
            polygonOptions: polyOptions,
            map: map
        });

        google.maps.event.addListener(drawingManager, 'overlaycomplete', function(e) {
            if (e.type != google.maps.drawing.OverlayType.MARKER) {
                // Switch back to non-drawing mode after drawing a shape.
                drawingManager.setDrawingMode(null);

                // Add an event listener that selects the newly-drawn shape when the user
                // mouses down on it.
                var newShape = e.overlay;
                newShape.type = e.type;
                google.maps.event.addListener(newShape, 'click', function() {
                    setSelection(newShape);
                });
                var areaB = google.maps.geometry.spherical.computeArea(newShape.getPath());
                if(areaB > 10000)
                {
                    document.getElementById("areaB").innerHTML = "Please draw a valid roof  area less than 10000 m&sup2";
                }
                else
                {
                    document.getElementById("areaB").innerHTML = "Your roof area is " + areaB.toFixed(0) + " m&sup2";
                    setSelection(newShape);
                    areaA = areaB.toFixed(0);
                }

            }
        });


        // Clear the current selection when the drawing mode is changed, or when the
        // map is clicked.
        google.maps.event.addListener(drawingManager, 'drawingmode_changed', clearSelection);
        google.maps.event.addListener(map, 'click', clearSelection);
        google.maps.event.addDomListener(document.getElementById('delete-button'), 'click', deleteAllShape());

    }

    google.maps.event.addDomListener(window, 'load', function(){
        initialize();

        google.maps.event.trigger(map, "resize");
    });
    $('#myModal').on('shown.bs.modal', function(e){
        google.maps.event.trigger(map, "resize");   });
    function saveRoof(){
        document.getElementById("area").value = areaA;
        document.getElementById("area").onchange = "addRoof()";

        $("#checkRoof").prop("checked", true);
        $("#area").show();

    }

    var options = {
        delay: -1
    };
    var trip = new Trip([
        {
            sel : $('#localization'),
            content : 'Type in your suburb name',
            expose: true
        },
        {
            sel : $('#checkTank'),
            content : 'If you have a tank, check here and type in your tank size',
            expose: true
        }
        ,
        {
            sel : $('#checkRoof'),
            content : 'If you know your roof area, just check here and type in your roof area',
            expose: true
        }
        ,
        {
            sel : $('#calculateR'),
            content : 'If you do not know your roof area, click this button to calculate now',
            expose: true
        },
        {
            sel : $('#peopleNum'),
            content : 'Type in the number of people in your house',
            expose: true
        }
        ,
        {
            sel : $('#submitAPI'),
            content : 'After all these input, get your tank water usage or tank suggestion',
            expose: true
        }

    ], options);

    trip.start();

    $(".trip-overlay").click(function() {
        trip.next();
    });






    $(document).ready(function() {
        // Cache selectors for faster performance.
        var $window = $(window),
            $mainMenuBar = $('#mainMenuBar'),
            $mainMenuBarAnchor = $('#mainMenuBarAnchor');

        // Run this on scroll events.
        $window.scroll(function() {
            var window_top = $window.scrollTop();
            var div_top = $mainMenuBarAnchor.offset().top;
            if (window_top > div_top) {
                // Make the div sticky.
                $mainMenuBar.addClass('stick');
                $mainMenuBarAnchor.height($mainMenuBar.height());
            }
            else {
                // Unstick the div.
                $mainMenuBar.removeClass('stick');
                $mainMenuBarAnchor.height(0);
            }
        });
    });

    var slideIndex = 1;

    showDivs(slideIndex);

    function plusDivs(n) {
        showDivs(slideIndex += n);
    }

    function showDivs(n) {
        var i;
        var x = document.getElementsByClassName("mySlides");
        var dots = document.getElementsByClassName("demo");
        if (n > x.length) {
            slideIndex = 1
        }
        if (n < 1) {
            slideIndex = x.length
        }
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }
        for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(" w3-white", "");
        }
        x[slideIndex - 1].style.display = "block";
        dots[slideIndex - 1].className += " w3-white";

    }
    function currentDiv(n) {
        showDivs(slideIndex = n);
    }

    setInterval(function () {
        plusDivs(1);
    }, 4000);

</script>
</html>
